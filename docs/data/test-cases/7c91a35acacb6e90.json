{"uid":"7c91a35acacb6e90","name":"test_module_delAll","fullName":"Tests.test_system.test_module.TestSModulePage#test_module_delAll","historyId":"5873475fd34f73ffa7487d4b6e96286f","time":{"start":1769548576625,"stop":1769548578774,"duration":2149},"status":"broken","statusMessage":"Exception: 点击失败：Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nSyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\n  (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nStacktrace:\nSymbols not available. Dumping unresolved backtrace:\n\t0x7ff7a57dfe35\n\t0x7ff7a57dfe90\n\t0x7ff7a556139d\n\t0x7ff7a556918f\n\t0x7ff7a556c1ef\n\t0x7ff7a556c2af\n\t0x7ff7a55b9637\n\t0x7ff7a55ba09c\n\t0x7ff7a560e8d7\n\t0x7ff7a560b61b\n\t0x7ff7a55aac6d\n\t0x7ff7a55abae3\n\t0x7ff7a5aaa10d\n\t0x7ff7a5aa448a\n\t0x7ff7a5ac5157\n\t0x7ff7a57fa81e\n\t0x7ff7a580262f\n\t0x7ff7a57e9324\n\t0x7ff7a57e94df\n\t0x7ff7a57cee88\n\t0x7ffc59d27374\n\t0x7ffc5a9fcc91","statusTrace":"self = <Pages.systemPage.apps_page.AppsPage object at 0x000001EC03CF4F40>, by_or_element = 'xpath', value = '//span[text()=\"系统设置\"])[1]', wait_time = 10, retries = 2\n\n    def click(self, by_or_element, value=None, wait_time=10, retries=2):\n        \"\"\"\n        更稳健的点击方法：支持定位符或 WebElement，自动处理 stale 元素、点击拦截等问题。\n        \"\"\"\n        for attempt in range(retries):\n            try:\n                if value is not None:\n                    by = by_or_element\n                    logging.info(f\"点击元素：By = {by}, Value = {value}\")\n>                   element = WebDriverWait(self.driver, wait_time).until(\n                        EC.element_to_be_clickable((by, value))\n                    )\n\nPages\\base_page.py:49: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py:129: in until\n    value = method(self._driver)\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\support\\expected_conditions.py:622: in _predicate\n    target = driver.find_element(*target)  # grab element at locator\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py:914: in find_element\n    return self.execute(Command.FIND_ELEMENT, {\"using\": by, \"value\": value})[\"value\"]\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py:447: in execute\n    self.error_handler.check_response(response)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <selenium.webdriver.remote.errorhandler.ErrorHandler object at 0x000001EC0415F160>\nresponse = {'status': 400, 'value': '{\"value\":{\"error\":\"invalid selector\",\"message\":\"invalid selector: Unable to locate an elemen...ff7a580262f\\\\n\\\\t0x7ff7a57e9324\\\\n\\\\t0x7ff7a57e94df\\\\n\\\\t0x7ff7a57cee88\\\\n\\\\t0x7ffc59d27374\\\\n\\\\t0x7ffc5a9fcc91\\\\n\"}}'}\n\n    def check_response(self, response: Dict[str, Any]) -> None:\n        \"\"\"Checks that a JSON response from the WebDriver does not have an\n        error.\n    \n        :Args:\n         - response - The JSON response from the WebDriver server as a dictionary\n           object.\n    \n        :Raises: If the response contains an error message.\n        \"\"\"\n        status = response.get(\"status\", None)\n        if not status or status == ErrorCode.SUCCESS:\n            return\n        value = None\n        message = response.get(\"message\", \"\")\n        screen: str = response.get(\"screen\", \"\")\n        stacktrace = None\n        if isinstance(status, int):\n            value_json = response.get(\"value\", None)\n            if value_json and isinstance(value_json, str):\n                import json\n    \n                try:\n                    value = json.loads(value_json)\n                    if len(value) == 1:\n                        value = value[\"value\"]\n                    status = value.get(\"error\", None)\n                    if not status:\n                        status = value.get(\"status\", ErrorCode.UNKNOWN_ERROR)\n                        message = value.get(\"value\") or value.get(\"message\")\n                        if not isinstance(message, str):\n                            value = message\n                            message = message.get(\"message\")\n                    else:\n                        message = value.get(\"message\", None)\n                except ValueError:\n                    pass\n    \n        exception_class: Type[WebDriverException]\n        e = ErrorCode()\n        error_codes = [item for item in dir(e) if not item.startswith(\"__\")]\n        for error_code in error_codes:\n            error_info = getattr(ErrorCode, error_code)\n            if isinstance(error_info, list) and status in error_info:\n                exception_class = getattr(ExceptionMapping, error_code, WebDriverException)\n                break\n        else:\n            exception_class = WebDriverException\n    \n        if not value:\n            value = response[\"value\"]\n        if isinstance(value, str):\n            raise exception_class(value)\n        if message == \"\" and \"message\" in value:\n            message = value[\"message\"]\n    \n        screen = None  # type: ignore[assignment]\n        if \"screen\" in value:\n            screen = value[\"screen\"]\n    \n        stacktrace = None\n        st_value = value.get(\"stackTrace\") or value.get(\"stacktrace\")\n        if st_value:\n            if isinstance(st_value, str):\n                stacktrace = st_value.split(\"\\n\")\n            else:\n                stacktrace = []\n                try:\n                    for frame in st_value:\n                        line = frame.get(\"lineNumber\", \"\")\n                        file = frame.get(\"fileName\", \"<anonymous>\")\n                        if line:\n                            file = f\"{file}:{line}\"\n                        meth = frame.get(\"methodName\", \"<anonymous>\")\n                        if \"className\" in frame:\n                            meth = f\"{frame['className']}.{meth}\"\n                        msg = \"    at %s (%s)\"\n                        msg = msg % (meth, file)\n                        stacktrace.append(msg)\n                except TypeError:\n                    pass\n        if exception_class == UnexpectedAlertPresentException:\n            alert_text = None\n            if \"data\" in value:\n                alert_text = value[\"data\"].get(\"text\")\n            elif \"alert\" in value:\n                alert_text = value[\"alert\"].get(\"text\")\n            raise exception_class(message, screen, stacktrace, alert_text)  # type: ignore[call-arg]  # mypy is not smart enough here\n>       raise exception_class(message, screen, stacktrace)\nE       selenium.common.exceptions.InvalidSelectorException: Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nE       SyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\nE         (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nE       Stacktrace:\nE       Symbols not available. Dumping unresolved backtrace:\nE       \t0x7ff7a57dfe35\nE       \t0x7ff7a57dfe90\nE       \t0x7ff7a556139d\nE       \t0x7ff7a556918f\nE       \t0x7ff7a556c1ef\nE       \t0x7ff7a556c2af\nE       \t0x7ff7a55b9637\nE       \t0x7ff7a55ba09c\nE       \t0x7ff7a560e8d7\nE       \t0x7ff7a560b61b\nE       \t0x7ff7a55aac6d\nE       \t0x7ff7a55abae3\nE       \t0x7ff7a5aaa10d\nE       \t0x7ff7a5aa448a\nE       \t0x7ff7a5ac5157\nE       \t0x7ff7a57fa81e\nE       \t0x7ff7a580262f\nE       \t0x7ff7a57e9324\nE       \t0x7ff7a57e94df\nE       \t0x7ff7a57cee88\nE       \t0x7ffc59d27374\nE       \t0x7ffc5a9fcc91\n\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\remote\\errorhandler.py:232: InvalidSelectorException\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_system.test_module.TestSModulePage object at 0x000001EC01A63B50>, login_to_module = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"29644b1e6cfc119ec16bd4200ed99232\")>\n\n    @allure.story(\"删除菜单，删除模块，删除应用成功\")\n    # @pytest.mark.run(order=1)\n    def test_module_delAll(self, login_to_module):\n        driver = login_to_module  # WebDriver 实例\n        module = ExpressionPage(driver)  # 用 driver 初始化 ExpressionPage\n        apps = AppsPage(driver)\n        module.click_button('(//span[text()=\"系统管理\"])[1]')\n        sleep(1)\n        ele = apps.get_find_element_xpath('(//span[text()=\"系统设置\"])[1]/ancestor::li[1]').get_attribute('aria-expanded')\n        if ele != 'true':\n>           apps.click_button(f'//span[text()=\"系统设置\"])[1]')\n\nTests\\test_system\\test_module.py:1308: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nPages\\systemPage\\apps_page.py:24: in click_button\n    self.click(By.XPATH, xpath)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <Pages.systemPage.apps_page.AppsPage object at 0x000001EC03CF4F40>, by_or_element = 'xpath', value = '//span[text()=\"系统设置\"])[1]', wait_time = 10, retries = 2\n\n    def click(self, by_or_element, value=None, wait_time=10, retries=2):\n        \"\"\"\n        更稳健的点击方法：支持定位符或 WebElement，自动处理 stale 元素、点击拦截等问题。\n        \"\"\"\n        for attempt in range(retries):\n            try:\n                if value is not None:\n                    by = by_or_element\n                    logging.info(f\"点击元素：By = {by}, Value = {value}\")\n                    element = WebDriverWait(self.driver, wait_time).until(\n                        EC.element_to_be_clickable((by, value))\n                    )\n                else:\n                    logging.info(\"点击元素：WebElement 对象\")\n                    element = by_or_element\n    \n                element.click()\n                logging.info(\"✅ 点击成功\")\n                return\n    \n            except ElementClickInterceptedException:\n                logging.warning(\"⚠️ 原生点击被拦截，尝试使用 JS 点击\")\n                try:\n                    self.driver.execute_script(\"arguments[0].click();\", element)\n                    logging.info(\"✅ JS 点击成功\")\n                    return\n                except Exception as js_error:\n                    logging.warning(f\"⚠️ JS 点击失败：{js_error}\")\n                    sleep(1)\n                    continue  # 下一轮重试\n    \n            except StaleElementReferenceException:\n                logging.warning(f\"⚠️ 第 {attempt + 1} 次点击失败：元素过期，尝试重新定位\")\n                sleep(1)\n                continue  # 下一轮重试时重新定位\n    \n            except TimeoutException:\n                logging.error(f\"❌ 元素未在 {wait_time} 秒内变为可点击\")\n                raise TimeoutException(f\"点击失败，找不到元素：{by_or_element} = {value}\")\n    \n            except Exception as e:\n                logging.warning(f\"点击失败：{e}\")\n                if attempt == retries - 1:\n>                   raise Exception(f\"点击失败：{e}\")\nE                   Exception: 点击失败：Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nE                   SyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\nE                     (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nE                   Stacktrace:\nE                   Symbols not available. Dumping unresolved backtrace:\nE                   \t0x7ff7a57dfe35\nE                   \t0x7ff7a57dfe90\nE                   \t0x7ff7a556139d\nE                   \t0x7ff7a556918f\nE                   \t0x7ff7a556c1ef\nE                   \t0x7ff7a556c2af\nE                   \t0x7ff7a55b9637\nE                   \t0x7ff7a55ba09c\nE                   \t0x7ff7a560e8d7\nE                   \t0x7ff7a560b61b\nE                   \t0x7ff7a55aac6d\nE                   \t0x7ff7a55abae3\nE                   \t0x7ff7a5aaa10d\nE                   \t0x7ff7a5aa448a\nE                   \t0x7ff7a5ac5157\nE                   \t0x7ff7a57fa81e\nE                   \t0x7ff7a580262f\nE                   \t0x7ff7a57e9324\nE                   \t0x7ff7a57e94df\nE                   \t0x7ff7a57cee88\nE                   \t0x7ffc59d27374\nE                   \t0x7ffc5a9fcc91\n\nPages\\base_page.py:83: Exception","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":false,"beforeStages":[{"name":"login_to_module","time":{"start":1769547744951,"stop":1769547758502,"duration":13551},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0}],"testStage":{"status":"broken","statusMessage":"Exception: 点击失败：Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nSyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\n  (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nStacktrace:\nSymbols not available. Dumping unresolved backtrace:\n\t0x7ff7a57dfe35\n\t0x7ff7a57dfe90\n\t0x7ff7a556139d\n\t0x7ff7a556918f\n\t0x7ff7a556c1ef\n\t0x7ff7a556c2af\n\t0x7ff7a55b9637\n\t0x7ff7a55ba09c\n\t0x7ff7a560e8d7\n\t0x7ff7a560b61b\n\t0x7ff7a55aac6d\n\t0x7ff7a55abae3\n\t0x7ff7a5aaa10d\n\t0x7ff7a5aa448a\n\t0x7ff7a5ac5157\n\t0x7ff7a57fa81e\n\t0x7ff7a580262f\n\t0x7ff7a57e9324\n\t0x7ff7a57e94df\n\t0x7ff7a57cee88\n\t0x7ffc59d27374\n\t0x7ffc5a9fcc91","statusTrace":"self = <Pages.systemPage.apps_page.AppsPage object at 0x000001EC03CF4F40>, by_or_element = 'xpath', value = '//span[text()=\"系统设置\"])[1]', wait_time = 10, retries = 2\n\n    def click(self, by_or_element, value=None, wait_time=10, retries=2):\n        \"\"\"\n        更稳健的点击方法：支持定位符或 WebElement，自动处理 stale 元素、点击拦截等问题。\n        \"\"\"\n        for attempt in range(retries):\n            try:\n                if value is not None:\n                    by = by_or_element\n                    logging.info(f\"点击元素：By = {by}, Value = {value}\")\n>                   element = WebDriverWait(self.driver, wait_time).until(\n                        EC.element_to_be_clickable((by, value))\n                    )\n\nPages\\base_page.py:49: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py:129: in until\n    value = method(self._driver)\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\support\\expected_conditions.py:622: in _predicate\n    target = driver.find_element(*target)  # grab element at locator\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py:914: in find_element\n    return self.execute(Command.FIND_ELEMENT, {\"using\": by, \"value\": value})[\"value\"]\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py:447: in execute\n    self.error_handler.check_response(response)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <selenium.webdriver.remote.errorhandler.ErrorHandler object at 0x000001EC0415F160>\nresponse = {'status': 400, 'value': '{\"value\":{\"error\":\"invalid selector\",\"message\":\"invalid selector: Unable to locate an elemen...ff7a580262f\\\\n\\\\t0x7ff7a57e9324\\\\n\\\\t0x7ff7a57e94df\\\\n\\\\t0x7ff7a57cee88\\\\n\\\\t0x7ffc59d27374\\\\n\\\\t0x7ffc5a9fcc91\\\\n\"}}'}\n\n    def check_response(self, response: Dict[str, Any]) -> None:\n        \"\"\"Checks that a JSON response from the WebDriver does not have an\n        error.\n    \n        :Args:\n         - response - The JSON response from the WebDriver server as a dictionary\n           object.\n    \n        :Raises: If the response contains an error message.\n        \"\"\"\n        status = response.get(\"status\", None)\n        if not status or status == ErrorCode.SUCCESS:\n            return\n        value = None\n        message = response.get(\"message\", \"\")\n        screen: str = response.get(\"screen\", \"\")\n        stacktrace = None\n        if isinstance(status, int):\n            value_json = response.get(\"value\", None)\n            if value_json and isinstance(value_json, str):\n                import json\n    \n                try:\n                    value = json.loads(value_json)\n                    if len(value) == 1:\n                        value = value[\"value\"]\n                    status = value.get(\"error\", None)\n                    if not status:\n                        status = value.get(\"status\", ErrorCode.UNKNOWN_ERROR)\n                        message = value.get(\"value\") or value.get(\"message\")\n                        if not isinstance(message, str):\n                            value = message\n                            message = message.get(\"message\")\n                    else:\n                        message = value.get(\"message\", None)\n                except ValueError:\n                    pass\n    \n        exception_class: Type[WebDriverException]\n        e = ErrorCode()\n        error_codes = [item for item in dir(e) if not item.startswith(\"__\")]\n        for error_code in error_codes:\n            error_info = getattr(ErrorCode, error_code)\n            if isinstance(error_info, list) and status in error_info:\n                exception_class = getattr(ExceptionMapping, error_code, WebDriverException)\n                break\n        else:\n            exception_class = WebDriverException\n    \n        if not value:\n            value = response[\"value\"]\n        if isinstance(value, str):\n            raise exception_class(value)\n        if message == \"\" and \"message\" in value:\n            message = value[\"message\"]\n    \n        screen = None  # type: ignore[assignment]\n        if \"screen\" in value:\n            screen = value[\"screen\"]\n    \n        stacktrace = None\n        st_value = value.get(\"stackTrace\") or value.get(\"stacktrace\")\n        if st_value:\n            if isinstance(st_value, str):\n                stacktrace = st_value.split(\"\\n\")\n            else:\n                stacktrace = []\n                try:\n                    for frame in st_value:\n                        line = frame.get(\"lineNumber\", \"\")\n                        file = frame.get(\"fileName\", \"<anonymous>\")\n                        if line:\n                            file = f\"{file}:{line}\"\n                        meth = frame.get(\"methodName\", \"<anonymous>\")\n                        if \"className\" in frame:\n                            meth = f\"{frame['className']}.{meth}\"\n                        msg = \"    at %s (%s)\"\n                        msg = msg % (meth, file)\n                        stacktrace.append(msg)\n                except TypeError:\n                    pass\n        if exception_class == UnexpectedAlertPresentException:\n            alert_text = None\n            if \"data\" in value:\n                alert_text = value[\"data\"].get(\"text\")\n            elif \"alert\" in value:\n                alert_text = value[\"alert\"].get(\"text\")\n            raise exception_class(message, screen, stacktrace, alert_text)  # type: ignore[call-arg]  # mypy is not smart enough here\n>       raise exception_class(message, screen, stacktrace)\nE       selenium.common.exceptions.InvalidSelectorException: Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nE       SyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\nE         (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nE       Stacktrace:\nE       Symbols not available. Dumping unresolved backtrace:\nE       \t0x7ff7a57dfe35\nE       \t0x7ff7a57dfe90\nE       \t0x7ff7a556139d\nE       \t0x7ff7a556918f\nE       \t0x7ff7a556c1ef\nE       \t0x7ff7a556c2af\nE       \t0x7ff7a55b9637\nE       \t0x7ff7a55ba09c\nE       \t0x7ff7a560e8d7\nE       \t0x7ff7a560b61b\nE       \t0x7ff7a55aac6d\nE       \t0x7ff7a55abae3\nE       \t0x7ff7a5aaa10d\nE       \t0x7ff7a5aa448a\nE       \t0x7ff7a5ac5157\nE       \t0x7ff7a57fa81e\nE       \t0x7ff7a580262f\nE       \t0x7ff7a57e9324\nE       \t0x7ff7a57e94df\nE       \t0x7ff7a57cee88\nE       \t0x7ffc59d27374\nE       \t0x7ffc5a9fcc91\n\nD:\\Python310\\lib\\site-packages\\selenium\\webdriver\\remote\\errorhandler.py:232: InvalidSelectorException\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_system.test_module.TestSModulePage object at 0x000001EC01A63B50>, login_to_module = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"29644b1e6cfc119ec16bd4200ed99232\")>\n\n    @allure.story(\"删除菜单，删除模块，删除应用成功\")\n    # @pytest.mark.run(order=1)\n    def test_module_delAll(self, login_to_module):\n        driver = login_to_module  # WebDriver 实例\n        module = ExpressionPage(driver)  # 用 driver 初始化 ExpressionPage\n        apps = AppsPage(driver)\n        module.click_button('(//span[text()=\"系统管理\"])[1]')\n        sleep(1)\n        ele = apps.get_find_element_xpath('(//span[text()=\"系统设置\"])[1]/ancestor::li[1]').get_attribute('aria-expanded')\n        if ele != 'true':\n>           apps.click_button(f'//span[text()=\"系统设置\"])[1]')\n\nTests\\test_system\\test_module.py:1308: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nPages\\systemPage\\apps_page.py:24: in click_button\n    self.click(By.XPATH, xpath)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <Pages.systemPage.apps_page.AppsPage object at 0x000001EC03CF4F40>, by_or_element = 'xpath', value = '//span[text()=\"系统设置\"])[1]', wait_time = 10, retries = 2\n\n    def click(self, by_or_element, value=None, wait_time=10, retries=2):\n        \"\"\"\n        更稳健的点击方法：支持定位符或 WebElement，自动处理 stale 元素、点击拦截等问题。\n        \"\"\"\n        for attempt in range(retries):\n            try:\n                if value is not None:\n                    by = by_or_element\n                    logging.info(f\"点击元素：By = {by}, Value = {value}\")\n                    element = WebDriverWait(self.driver, wait_time).until(\n                        EC.element_to_be_clickable((by, value))\n                    )\n                else:\n                    logging.info(\"点击元素：WebElement 对象\")\n                    element = by_or_element\n    \n                element.click()\n                logging.info(\"✅ 点击成功\")\n                return\n    \n            except ElementClickInterceptedException:\n                logging.warning(\"⚠️ 原生点击被拦截，尝试使用 JS 点击\")\n                try:\n                    self.driver.execute_script(\"arguments[0].click();\", element)\n                    logging.info(\"✅ JS 点击成功\")\n                    return\n                except Exception as js_error:\n                    logging.warning(f\"⚠️ JS 点击失败：{js_error}\")\n                    sleep(1)\n                    continue  # 下一轮重试\n    \n            except StaleElementReferenceException:\n                logging.warning(f\"⚠️ 第 {attempt + 1} 次点击失败：元素过期，尝试重新定位\")\n                sleep(1)\n                continue  # 下一轮重试时重新定位\n    \n            except TimeoutException:\n                logging.error(f\"❌ 元素未在 {wait_time} 秒内变为可点击\")\n                raise TimeoutException(f\"点击失败，找不到元素：{by_or_element} = {value}\")\n    \n            except Exception as e:\n                logging.warning(f\"点击失败：{e}\")\n                if attempt == retries - 1:\n>                   raise Exception(f\"点击失败：{e}\")\nE                   Exception: 点击失败：Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nE                   SyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\nE                     (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nE                   Stacktrace:\nE                   Symbols not available. Dumping unresolved backtrace:\nE                   \t0x7ff7a57dfe35\nE                   \t0x7ff7a57dfe90\nE                   \t0x7ff7a556139d\nE                   \t0x7ff7a556918f\nE                   \t0x7ff7a556c1ef\nE                   \t0x7ff7a556c2af\nE                   \t0x7ff7a55b9637\nE                   \t0x7ff7a55ba09c\nE                   \t0x7ff7a560e8d7\nE                   \t0x7ff7a560b61b\nE                   \t0x7ff7a55aac6d\nE                   \t0x7ff7a55abae3\nE                   \t0x7ff7a5aaa10d\nE                   \t0x7ff7a5aa448a\nE                   \t0x7ff7a5ac5157\nE                   \t0x7ff7a57fa81e\nE                   \t0x7ff7a580262f\nE                   \t0x7ff7a57e9324\nE                   \t0x7ff7a57e94df\nE                   \t0x7ff7a57cee88\nE                   \t0x7ffc59d27374\nE                   \t0x7ffc5a9fcc91\n\nPages\\base_page.py:83: Exception","steps":[],"attachments":[{"uid":"95107c9d04206b9e","name":"test_module_delAll_20260128_051618","source":"95107c9d04206b9e.png","type":"image/png","size":258711},{"uid":"f8bdf08a4e20d05a","name":"test_module_delAll_20260128_051619","source":"f8bdf08a4e20d05a.png","type":"image/png","size":19252},{"uid":"eb95a7f419b7f493","name":"test_module_delAll_20260128_051619","source":"eb95a7f419b7f493.png","type":"image/png","size":25727},{"uid":"83634f22928a9d30","name":"test_module_delAll_20260128_051619","source":"83634f22928a9d30.png","type":"image/png","size":19252},{"uid":"52039d39fe735958","name":"test_module_delAll_20260128_051619","source":"52039d39fe735958.png","type":"image/png","size":19252},{"uid":"5a7d2f4b3591e7a1","name":"test_module_delAll_20260128_051619","source":"5a7d2f4b3591e7a1.png","type":"image/png","size":25727},{"uid":"c774a00cf22ba02f","name":"test_module_delAll_20260128_051619","source":"c774a00cf22ba02f.png","type":"image/png","size":25727},{"uid":"e6f6b974a4fca673","name":"test_module_delAll_20260128_051619","source":"e6f6b974a4fca673.png","type":"image/png","size":19252},{"uid":"1fb9739a4da6dfa8","name":"test_module_delAll_20260128_051619","source":"1fb9739a4da6dfa8.png","type":"image/png","size":25727},{"uid":"c30f8caa02629c6b","name":"test_module_delAll_20260128_051619","source":"c30f8caa02629c6b.png","type":"image/png","size":25727},{"uid":"87049443c6fb77a","name":"test_module_delAll_20260128_051619","source":"87049443c6fb77a.png","type":"image/png","size":19252},{"uid":"284fd97756d0fb7c","name":"test_module_delAll_20260128_051620","source":"284fd97756d0fb7c.png","type":"image/png","size":25727},{"uid":"9f679c4274afd4ce","name":"test_module_delAll_20260128_051620","source":"9f679c4274afd4ce.png","type":"image/png","size":25727},{"uid":"cd7d4a5f9d20bcbe","name":"test_module_delAll_20260128_051620","source":"cd7d4a5f9d20bcbe.png","type":"image/png","size":25727},{"uid":"9edba8ec4556dd70","name":"test_module_delAll_20260128_051620","source":"9edba8ec4556dd70.png","type":"image/png","size":19252},{"uid":"289cea3ca2e8e3a4","name":"test_module_delAll_20260128_051620","source":"289cea3ca2e8e3a4.png","type":"image/png","size":25727},{"uid":"435d940440208c5e","name":"test_module_delAll_20260128_051620","source":"435d940440208c5e.png","type":"image/png","size":19252},{"uid":"1504e06c297b5e85","name":"test_module_delAll_20260128_051620","source":"1504e06c297b5e85.png","type":"image/png","size":156576},{"uid":"fa173243979b5599","name":"log","source":"fa173243979b5599.txt","type":"text/plain","size":4753}],"parameters":[],"attachmentStep":false,"hasContent":true,"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":19},"afterStages":[{"name":"login_to_module::0","time":{"start":1769548978229,"stop":1769548980403,"duration":2174},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0}],"labels":[{"name":"story","value":"删除菜单，删除模块，删除应用成功"},{"name":"feature","value":"模块管理页用例"},{"name":"parentSuite","value":"Tests.test_system"},{"name":"suite","value":"test_module"},{"name":"subSuite","value":"TestSModulePage"},{"name":"host","value":"DESKTOP-L7L44NB"},{"name":"thread","value":"15128-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"Tests.test_system.test_module"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"4ab07f6feee4e29b","status":"broken","statusDetails":"Exception: 点击失败：Message: invalid selector: Unable to locate an element with the xpath expression //span[text()=\"系统设置\"])[1] because of the following error:\nSyntaxError: Failed to execute 'evaluate' on 'Document': The string '//span[text()=\"系统设置\"])[1]' is not a valid XPath expression.\n  (Session info: chrome=142.0.7444.60); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalid-selector-exception\nStacktrace:\nSymbols not available. Dumping unresolved backtrace:\n\t0x7ff7a57dfe35\n\t0x7ff7a57dfe90\n\t0x7ff7a556139d\n\t0x7ff7a556918f\n\t0x7ff7a556c1ef\n\t0x7ff7a556c2af\n\t0x7ff7a55b9637\n\t0x7ff7a55ba09c\n\t0x7ff7a560e8d7\n\t0x7ff7a560b61b\n\t0x7ff7a55aac6d\n\t0x7ff7a55abae3\n\t0x7ff7a5aaa10d\n\t0x7ff7a5aa448a\n\t0x7ff7a5ac5157\n\t0x7ff7a57fa81e\n\t0x7ff7a580262f\n\t0x7ff7a57e9324\n\t0x7ff7a57e94df\n\t0x7ff7a57cee88\n\t0x7ffc59d27374\n\t0x7ffc5a9fcc91","time":{"start":1769548572300,"stop":1769548574512,"duration":2212}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"tags":[]},"source":"7c91a35acacb6e90.json","parameterValues":[]}